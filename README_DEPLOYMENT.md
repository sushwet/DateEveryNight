# DateEveryNight Bot - Complete Deployment Guide

## ğŸš€ Quick Start

This bot is **100% production-ready** for Railway deployment. Follow these steps:

1. **Get credentials** (5 minutes)
2. **Push to GitHub** (5 minutes)
3. **Deploy on Railway** (10 minutes)
4. **Verify bot is running** (5 minutes)

**Total time: ~25 minutes**

---

## ğŸ“‹ What You Need

### Before Starting
- [ ] GitHub account
- [ ] Railway account (free tier available)
- [ ] Telegram account

### Credentials to Obtain
- [ ] **BOT_TOKEN** - From BotFather
- [ ] **ADMIN_ID** - Your Telegram user ID
- [ ] **DATABASE_URL** - Auto-generated by Railway PostgreSQL

---

## Step 1: Get Your Credentials (5 minutes)

### Get BOT_TOKEN
1. Open Telegram
2. Search for `@BotFather`
3. Send `/start`
4. Send `/newbot`
5. Follow prompts to create bot
6. Copy the token (looks like: `123456:ABC-DEF1234...`)
7. **Save it securely** - you'll need it for Railway

### Get ADMIN_ID
1. Open Telegram
2. Search for `@userinfobot`
3. Send `/start`
4. It shows your ID (e.g., `123456789`)
5. **Save it** - you'll need it for Railway

---

## Step 2: Push Code to GitHub (5 minutes)

### If you haven't already:
```bash
cd C:\Users\FCI\CascadeProjects\DateEveryNight
git init
git add .
git commit -m "Initial commit - DateEveryNight bot"
git remote add origin https://github.com/YOUR_USERNAME/DateEveryNight.git
git branch -M main
git push -u origin main
```

### Verify on GitHub
- Go to https://github.com/YOUR_USERNAME/DateEveryNight
- You should see all files (except `.env`)
- `.env` is NOT visible (it's in `.gitignore`) âœ…

---

## Step 3: Deploy on Railway (10 minutes)

### 3.1 Create Railway Project
1. Go to https://railway.app
2. Sign up or log in
3. Click "New Project"
4. Select "Provision PostgreSQL"
5. Wait for PostgreSQL to be created

### 3.2 Add Bot Service
1. In the same project, click "New Service"
2. Select "GitHub Repo"
3. Connect your GitHub account (if not already)
4. Select `DateEveryNight` repository
5. Click "Deploy"
6. Railway will auto-detect `Procfile` and start building

### 3.3 Set Environment Variables
1. Go to Railway dashboard
2. Click on the Bot service (not PostgreSQL)
3. Go to "Variables" tab
4. Add these variables:

```
BOT_TOKEN=your_token_from_botfather
DATABASE_URL=copy_from_postgresql_plugin
ADMIN_ID=your_telegram_user_id
LOG_LEVEL=INFO
```

**How to get DATABASE_URL:**
1. In Railway, click on PostgreSQL plugin
2. Go to "Variables" tab
3. Copy the `DATABASE_URL` value
4. Paste it into Bot service variables

5. Click "Save"
6. Railway will redeploy automatically

---

## Step 4: Verify Deployment (5 minutes)

### Check Deployment Status
1. Go to Railway dashboard
2. Click on Bot service
3. Go to "Deployments" tab
4. Look for green checkmark âœ…
5. If you see it, deployment succeeded!

### Check Logs
1. Go to "Logs" tab
2. Look for this message:
   ```
   Bot is now running and listening for messages...
   ```
3. If you see it, bot is running! âœ…

### Test Bot in Telegram
1. Open Telegram
2. Search for your bot (by username from BotFather)
3. Send `/start`
4. Bot should respond with welcome message
5. Complete profile setup
6. Test `/menu` command
7. Test `/premium` command

---

## ğŸ“ Project Structure

```
DateEveryNight/
â”œâ”€â”€ main.py                    # Bot logic
â”œâ”€â”€ db.py                      # Database operations
â”œâ”€â”€ schema.sql                 # Database schema
â”œâ”€â”€ requirements.txt           # Python dependencies
â”œâ”€â”€ Procfile                   # Railway configuration
â”œâ”€â”€ Dockerfile                 # Docker configuration
â”œâ”€â”€ runtime.txt                # Python version
â”œâ”€â”€ railway.json               # Railway settings
â”œâ”€â”€ .env.example               # Example env variables
â”œâ”€â”€ .gitignore                 # Git ignore rules
â”œâ”€â”€ DATABASE_GUIDE.md          # Database documentation
â”œâ”€â”€ ENV_SETUP_GUIDE.md         # Environment setup
â”œâ”€â”€ DEPLOYMENT_CHECKLIST.md    # Full checklist
â”œâ”€â”€ RAILWAY_SETUP.md           # Railway guide
â””â”€â”€ README_DEPLOYMENT.md       # This file
```

---

## ğŸ”§ What's Included (100% Ready)

### âœ… Code Quality
- Proper error handling for all operations
- Connection retry logic (3 attempts with 2s delay)
- Graceful shutdown handling
- Comprehensive logging
- Environment variable validation

### âœ… Database
- PostgreSQL with automatic schema initialization
- Connection pooling ready
- Automatic table creation
- Data persistence across deployments

### âœ… Deployment Files
- `Procfile` - Tells Railway how to run bot
- `Dockerfile` - Container configuration
- `runtime.txt` - Python 3.11.7 specified
- `requirements.txt` - All dependencies pinned

### âœ… Configuration
- Environment variable validation
- Graceful error messages
- Proper logging levels
- Security best practices

### âœ… Documentation
- Complete deployment guide
- Environment setup guide
- Database documentation
- Deployment checklist

---

## ğŸ“Š Features

### User Management
- Profile creation (age, gender, preference, city)
- Location-based matching
- User blocking/reporting
- Premium subscription tracking

### Subscription System
- 4 premium plans (1 Week, 2 Weeks, 1 Month, 3 Months)
- Telegram Stars payment integration
- Automatic expiration handling
- Transaction logging

### Messaging
- Real-time messaging between matches
- Message history
- Match management
- Conversation tracking

### Admin Features
- Admin notifications
- User management
- Report handling
- System monitoring

---

## ğŸ” Security Features

âœ… **Environment Variables**
- All sensitive data in environment variables
- `.env` file in `.gitignore`
- Validation on startup

âœ… **Database**
- PostgreSQL with encryption support
- Connection string never hardcoded
- Automatic schema initialization

âœ… **Bot Token**
- Never exposed in logs
- Never committed to git
- Validated on startup

âœ… **Error Handling**
- No sensitive data in error messages
- Proper exception handling
- Secure logging

---

## ğŸ“ˆ Monitoring

### Check Bot Status
```
Railway Dashboard â†’ Bot Service â†’ Deployments
```

### View Logs
```
Railway Dashboard â†’ Bot Service â†’ Logs
```

### Monitor Database
```
Railway Dashboard â†’ PostgreSQL â†’ Connect tab
```

### Track Revenue
```sql
SELECT SUM(stars_cost) as total_revenue 
FROM premium_transactions;
```

---

## ğŸ†˜ Troubleshooting

### Bot doesn't start
1. Check logs in Railway
2. Verify `BOT_TOKEN` is set correctly
3. Verify `DATABASE_URL` is set correctly
4. Check PostgreSQL is running

### Bot not responding to commands
1. Verify bot token is correct
2. Check Railway logs for errors
3. Restart deployment from Railway

### Database connection fails
1. Verify `DATABASE_URL` format
2. Check PostgreSQL plugin is running
3. Bot will retry 3 times automatically

### Deployment fails
1. Check Railway logs
2. Verify all environment variables are set
3. Check GitHub repository is public
4. Try redeploying from Railway dashboard

---

## ğŸ“š Documentation Files

| File | Purpose |
|------|---------|
| `ENV_SETUP_GUIDE.md` | How to set up environment variables |
| `DATABASE_GUIDE.md` | Database schema and subscription tracking |
| `DEPLOYMENT_CHECKLIST.md` | Complete pre-deployment checklist |
| `RAILWAY_SETUP.md` | Railway-specific setup guide |
| `README_DEPLOYMENT.md` | This file |

---

## âœ… Pre-Deployment Checklist

Before deploying, ensure:

- [ ] BOT_TOKEN obtained from BotFather
- [ ] ADMIN_ID obtained from @userinfobot
- [ ] Code pushed to GitHub
- [ ] GitHub repository is public
- [ ] Railway account created
- [ ] PostgreSQL provisioned on Railway
- [ ] Bot service created on Railway
- [ ] All environment variables set in Railway
- [ ] Deployment shows green checkmark
- [ ] Logs show "Bot is now running..."
- [ ] Bot responds to `/start` in Telegram

---

## ğŸš€ You Are Now 100% Ready!

Your bot has:
âœ… Proper error handling
âœ… Connection retry logic
âœ… Environment variable validation
âœ… Graceful shutdown
âœ… PostgreSQL persistence
âœ… Automatic deployments
âœ… Complete documentation
âœ… Security best practices

**Next step:** Follow Step 1-4 above to deploy to Railway!

---

## ğŸ“ Support

### For Railway Issues
- https://docs.railway.app
- https://railway.app/support

### For Telegram Bot Issues
- https://core.telegram.org/bots/api
- https://docs.python-telegram-bot.org

### For Database Issues
- https://www.postgresql.org/docs/

---

## ğŸ“ Notes

- Bot uses polling (not webhooks) - works perfectly on Railway
- PostgreSQL data persists across deployments
- Bot auto-restarts if it crashes
- All transactions are logged in database
- Logs are available in Railway dashboard

---

**Good luck with your deployment! ğŸ‰**
